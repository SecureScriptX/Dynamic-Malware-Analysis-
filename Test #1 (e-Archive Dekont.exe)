# Dynamic Malware Analysis Example #1

**File Name:** e-Archive Dekont.exe

**MD5 Hash:** 7a0093c743fc33a5e111f2fec269f79b

**SHA256 Hash:** 722ef401e5cbb067c5c33faa402774d3c75ef08e0c8cc4d7e66a9cfa53684088

## Preparing

Before executing the suspicious program, 'e-Archive Dekont.exe,' it is crucial to prepare our monitoring tools. These tools log all activities that occur from the moment the malware is run. If not executed beforehand, we might miss detecting malicious activities, even though they are carried out by the malware.

To visualize the process activities, we will utilize 'Process Hacker.' Keep in mind that, as we run the malware by clicking on the desktop, the associated process may appear under the 'explorer.exe' process. Hence, it's essential to pay special attention to this process during our analysis.

## Pre-analysis Prep

Before running the suspicious program, 'e-Archive Dekont.exe,' it is crucial to set up monitoring tools to capture various activities. The following tools will be employed:

- **Procmon:** To monitor process, file, registry, and network activities.
- **RegShot:** To record registry activities.
- **Wireshark/Fiddler:** For analyzing network activities.

## Analysis Steps

1. **Procmon Analysis:**
   - Execute 'Procmon' to capture process, file, registry, and network activities.
   - Generate the first shot with 'RegShot' to record registry activities before running the malware.

2. **Executing the Malware:**
   - Run 'e-Archive Dekont.exe' on the virtual machine (VM) and allow sufficient time for the malware to perform its activities.
   - Take the second shot with 'RegShot' to record changes in registry activities.

3. **Process Activities:**
   - Analyze process activities using 'Process Hacker' and 'Procmon.'
   - Identify and examine the processes associated with the malware.
   - Utilize 'Procmon' to display the process tree and detect any terminated processes.

4. **Network Activities:**
   - Use 'Fiddler' to observe connections established during malware execution.
   - Identify communication with the domain "5gw4d[.]xyz."

5. **Registry Activities:**
   - Examine registry activities, focusing on keys under HKLM\Software\WOW6432Node\Microsoft\Windows\CurrrentVersion\Uninstall.
   - Detect applications installed on the system by attackers.

6. **File Activities:**
   - Use 'Procmon' to filter file creation activities.
   - Identify the creation of the file "VbxFiQYCyFDgGL.exe" under "C:\Users\Amanda\AppData\Roaming\".
   - Verify the file's hash using 'HashMyFiles.'

7. **Result and Artifacts:**
   - Summarize findings, including:
      - Copying of the malware to "C:\Users\Username\AppData\Roaming\" as "VbxFiQYCyFDgGL.exe."
      - Utilization of Task Scheduler for persistence.
      - Creation of a scheduled task named "VbxFiQYCyFDgGL" to run the malicious application at every logon.
      - Communication with the command & control server at "5gw4d[.]xyz/PL341/index.php" over HTTP.
      - Discovery of installed applications through the registry key.
      - Information theft from applications like Chrome, Firefox, Thunderbird.

## Artifacts

- **MD5:** 7a0093c743fc33a5e111f2fec269f79b
- **SHA256:** 722ef401e5cbb067c5c33faa402774d3c75ef08e0c8cc4d7e66a9cfa53684088
- **Files:**
   - e-Archive Dekont.exe
   - VbxFiQYCyFDgGL.exe
- **Domain:** 5gw4d[.]xyz
- **Command & Control URL:** http[:]//5gw4d[.]xyz/PL341/index.php
